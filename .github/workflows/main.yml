name: Cross Compile releases 

on:
  push:
    branches: [ main, cicd ]

defaults:
  run:
    shell: bash

jobs:
  build_and_test:
    name: >
      Build and test a ${{ matrix.build }} version of Lamscript on
      ${{ matrix.os }} with ${{ matrix.compiler }}.
    runs-on: ${{ matrix.os }}
    strategy:
      matrix:
        os: [ubuntu-latest, macos-latest]
        compiler: [ g++-10 ]
        build: [Release, Debug]
        include:
          - os: ubuntu-latest
            target: Linux
          - os: macos-latest
            target: Macos

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4

      - name: Run the projects setup.
        run: ./build-scripts/bootstrap-v.sh
        shell: bash

